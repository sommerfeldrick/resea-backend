# ============================================================
# Server Configuration
# ============================================================
PORT=3001
NODE_ENV=development
FRONTEND_URL=http://localhost:5173

# ============================================================
# Database Configuration (PostgreSQL)
# ============================================================
# Configure com a URL do Render PostgreSQL
# Formato: postgresql://user:password@host:port/dbname
# No Render, copie a URL de conexão do seu banco PostgreSQL
DATABASE_URL=postgresql://user:password@localhost:5432/resea_db

# ============================================================
# SmileAI Integration
# ============================================================
MAIN_DOMAIN_API=https://smileai.com.br
SMILEAI_API_URL=https://smileai.com.br/api
SMILEAI_API_KEY=your_smileai_api_key_here
SMILEAI_CLIENT_ID=your_client_id_here
SMILEAI_CLIENT_SECRET=your_client_secret_here

# ============================================================
# Redis Configuration (OPCIONAL - Cache & Performance)
# ============================================================
# Redis é OPCIONAL. Se não estiver disponível, a aplicação usa cache em memória
# Configure apenas se você tiver Redis rodando localmente ou em um serviço (Upstash, AWS ElastiCache, etc)
REDIS_ENABLED=true
REDIS_URL=redis://localhost:6379

# Para ativar com Upstash (Redis na nuvem - GRÁTIS):
# 1. Acesse https://upstash.com/ e crie uma conta gratuita
# 2. Crie um novo Redis database (Free tier - 10.000 comandos/dia)
# 3. Copie a URL de conexão e configure aqui
# 4. Mude REDIS_ENABLED para true
# Exemplo: REDIS_URL=redis://default:sua_senha@seu_host:porta

# ============================================================
# AI Providers - MULTI-PROVIDER SYSTEM (GRATUITAS + FALLBACK)
# ============================================================
# Sistema com foco em DeepSeek + Gemini + OpenAI
# Prioridade: DeepSeek (5M tok/mês) → Gemini (1M tok/dia) → OpenAI (pago)
#
# Documentação: Ver MODELO_MULTIPROVEDOR_COMPLETO.md

# 1️⃣ DEEPSEEK - PRIMARY (5M tokens/mês GRÁTIS - DeepSeek V3.2-Exp)
# Prioridade: 1 (primeira opção - ultra-poderoso)
# https://platform.deepseek.com
#
# Modelos disponíveis:
# - deepseek-chat (V3.2-Exp) - Modo normal, sem raciocínio explícito (recomendado)
# - deepseek-reasoner (V3.2-Exp) - Modo THINKING com raciocínio explícito (tasks complexas)
#
# Nota: deepseek-reasoner retorna tags <think>...</think> antes da resposta
# (já tratadas automaticamente pelo cleanJsonResponse)
DEEPSEEK_API_KEY=your_deepseek_api_key_here
DEEPSEEK_MODEL=deepseek-chat

# 2️⃣ GOOGLE GEMINI - SECONDARY (250 req/day, 1M tokens/day)
# Prioridade: 2 (segunda opção)
# https://aistudio.google.com/app/apikeys
# Modelos: gemini-2.0-flash
GEMINI_API_KEY=your_gemini_api_key_here
GEMINI_MODEL=gemini-2.0-flash

# 3️⃣ OPENAI - TERTIARY (PAGO - GPT-4o-mini)
# Prioridade: 3 (terceira opção - fallback pago)
# https://platform.openai.com/api-keys
# Modelos: gpt-4o-mini (mais barato)
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_MODEL=gpt-4o-mini

# Quais providers ativar (separados por vírgula)
# Padrão: deepseek,gemini,openai
ENABLED_PROVIDERS=deepseek,gemini,openai

# Ordem de fallback quando providers atingem limite
# Padrão: deepseek → gemini → openai
PROVIDER_FALLBACK_ORDER=deepseek,gemini,openai

# ============================================================
# AI Providers - LEGACY SUPPORT (Ainda suportados, Opcionais)
# ============================================================
# Nota: Together.AI e Cohere foram removidos do código atual


# ============================================================
# Academic Search APIs - GRATUITAS (Opcional - aumenta resultados)
# ============================================================

# Semantic Scholar - GRÁTIS (100 req/min - Opcional, aumenta para 5k com key)
# https://www.semanticscholar.org/product/api
SEMANTIC_SCHOLAR_KEY=your_semantic_scholar_key_here

# CORE API - GRÁTIS (10k req/dia - Recomendado)
# https://core.ac.uk/services/api
CORE_API_KEY=your_core_api_key_here

# ============================================================
# Academic Search APIs - PAGAS (Emergência - $0.001/req)
# ============================================================

# CrossRef - PAGO (Só usa se TODAS as 7 fontes gratuitas falharem)
# https://www.crossref.org/documentation/retrieve-metadata/rest-api/
CROSSREF_API_KEY=your_crossref_api_key_here

# ============================================================
# Rate Limiting
# ============================================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ============================================================
# File Upload
# ============================================================
MAX_FILE_SIZE=52428800
UPLOAD_DIR=./uploads

# ============================================================
# Research Settings
# ============================================================
ENABLE_WEB_SCRAPING=true
MAX_SCRAPING_SOURCES=10
SCRAPING_TIMEOUT=10000

# Auto Indexing (OPCIONAL - Desabilitado por padrão)
# Quando habilitado, indexa papers automaticamente baseado em buscas dos usuários
# false = Papers são indexados apenas quando o usuário busca (recomendado)
# true = Sistema sincroniza papers automaticamente a cada N minutos
ENABLE_AUTO_INDEXING=false

# Intervalo de sincronização automática (apenas se ENABLE_AUTO_INDEXING=true)
# Padrão: 60 minutos
SYNC_INTERVAL_MINUTES=60

# ============================================================
# Logging
# ============================================================
LOG_LEVEL=info
LOG_FILE=./logs/app.log

# ================================
# Full Text Extraction Settings
# ================================

# GROBID Service URL (for PDF full-text extraction)
GROBID_URL=http://localhost:8070

# Unpaywall API Email (for discovering Open Access PDFs)
UNPAYWALL_EMAIL=your-email@example.com

# Redis URL (for caching extraction results)
REDIS_URL=redis://localhost:6379

# ================================
# Hybrid Search & Vector DB (Phase 1)
# ================================

# Qdrant Vector Database URL
QDRANT_URL=http://localhost:6333

# Ollama Cloud API (1M tokens/dia GRÁTIS)
# Obtenha sua chave em: https://ollama.com/settings/keys
OLLAMA_API_KEY=your_ollama_api_key_here
OLLAMA_BASE_URL=https://api.ollama.com
# Alternativa: OLLAMA_URL=https://api.ollama.com

# Embedding Model (Ollama Cloud - multilingual support)
# Modelos disponíveis: nomic-embed-text, mxbai-embed-large
EMBEDDING_MODEL=nomic-embed-text

# Reranker Model (Ollama Cloud LLM for reranking)
# Modelos disponíveis: llama3.2, phi3, gemma2, qwen2.5
RERANKER_MODEL=llama3.2

# Hybrid Search Weights (Vector + BM25)
VECTOR_WEIGHT=0.7
BM25_WEIGHT=0.3

# ================================
# Cloudflare R2 Storage (Document Storage)
# ================================
# Cloudflare R2 é compatível com S3 API, mais barato que AWS S3
# Vantagens: Sem custo de egress (download gratuito), $0.015/GB/mês
# Como obter: https://dash.cloudflare.com/r2

# Habilitar storage em nuvem (se false, usa PostgreSQL)
R2_ENABLED=false

# Cloudflare R2 Account ID (encontre em: Cloudflare Dashboard > R2)
R2_ACCOUNT_ID=your_cloudflare_account_id_here

# Nome do bucket R2 (crie em: Cloudflare Dashboard > R2 > Create Bucket)
R2_BUCKET_NAME=resea-documents

# R2 Access Key ID (crie em: R2 > Manage R2 API Tokens)
R2_ACCESS_KEY_ID=your_r2_access_key_id_here

# R2 Secret Access Key
R2_SECRET_ACCESS_KEY=your_r2_secret_access_key_here

# Região (R2 é global, mas use 'auto' ou 'us-east-1')
R2_REGION=auto

# Domínio público personalizado (opcional)
# Se você configurou um custom domain no R2, coloque aqui
# Exemplo: https://cdn.seusite.com
R2_PUBLIC_DOMAIN=

# ================================
# AWS S3 Storage (Alternativa ao R2)
# ================================
# Se preferir AWS S3 ao invés de Cloudflare R2, configure aqui
# Nota: R2 é mais barato e usa a mesma API do S3

# AWS_REGION=us-east-1
# AWS_ACCESS_KEY_ID=your_aws_access_key_here
# AWS_SECRET_ACCESS_KEY=your_aws_secret_key_here
# AWS_S3_BUCKET=your-bucket-name

# ================================
# Credits & Document Limits (Sistema de Créditos)
# ================================
# Configure quantos documentos cada plano pode gerar por mês
# Os planos correspondem aos da SmileAI:
#   - Básico (Mensal: R$ 49,90 / Anual: R$ 478,80)
#   - Intermediário (Mensal: R$ 99,90 / Anual: R$ 838,80)
#   - Avançado (Mensal: R$ 149,90 / Anual: R$ 1.078,80)

# Plano Básico - Limite de documentos por mês
PLAN_BASICO_LIMIT=5

# Plano Intermediário - Limite de documentos por mês
PLAN_INTERMEDIARIO_LIMIT=15

# Plano Avançado - Limite de documentos por mês
PLAN_AVANCADO_LIMIT=50

# Plano Enterprise (futuro) - Limite de documentos por mês
PLAN_ENTERPRISE_LIMIT=100

# Plano Free/Trial (sem pagamento) - Limite de documentos por mês
PLAN_FREE_LIMIT=0
